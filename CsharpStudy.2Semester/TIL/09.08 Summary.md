## TODAY NOTE C# [비동기 프로그래밍]  [ 25.09.08 ]

### 동기 vs 비동기 프로그래밍

- 동기(Synchronous) 프로그래밍
    - 코드가 순서대로 실행되며, 한 작업이 완료될 때까지 다음 작업은 기다려야 합니다.
    - 이는 1차선 도로에서 느린 차 때문에 전체 흐름이 느려지는 것과 같습니다.


- 비동기(Asynchronous) 프로그래밍
    - 작업이 완료될 때까지 기다리지 않고 다른 작업을 시작할 수 있는 방식입니다.
    - 핵심은 메인 스레드를 차단하지 않는 것으로, 예를 들어 대용량 파일을 다운로드하는 중에도 사용자는 다른 UI 조작을 할 수 있습니다.

### 동시성 vs 병렬성

- 동시성(Concurrency)
    - 여러 작업이 논리적으로 동시에 실행되는 것처럼 보이는 개념입니다(싱글 코어). 선생님 한 분이 여러 가지 일을 번갈아 처리하는 것에 비유할 수 있습니다.

- 병렬성(Parallelism)
    - 여러 작업이 물리적으로 동시에 실행되는 개념입니다(멀티 코어). 선생님과 조교가 함께 일을 처리하는 것에 비유할 수 있습니다.

### 비동기 프로그래밍은 동시성과 병렬성 개념을 활용하여 성능을 극대화하는 기술

### 콜백함수 사용 (delegate 나 event로 구현)

- `Task<T>` : 비동기적으로 수행될 작업을 나타내는 객체
- `ContinueWith()` : Task가 완료된 후 실행될 작업을 지정하는 메서드(콜백방식)

### 콜백 방식의 문제점

- 과거에는 비동기 작업을 처리하기 위해 콜백(Callback) 함수를 많이 사용했습니다. 하지만 콜백 방식은 다음과 같은 문제점이 있습니다.
- 콜백 지옥(Callback Hell): 여러 비동기 작업이 순차적으로 의존성을 가질 때, 콜백 함수가 중첩되어 코드의 가독성과 유지보수성이 급격히 저하됩니다.
- 디버깅의 어려움: 에러 추적이 힘들어집니다.
- 예외 처리의 어려움: `try-catch 문`을 사용한 예외 처리가 어렵습니다.

### `async` / `await` 문법

- C#에서는 콜백 지옥 문제를 해결하기 위해 `async`와 a`wait` 키워드를 제공합니다.
- `ContinueWith()`를 활용한 콜백을 대체하는 방식으로 간편하고 권장됩니다.
- `async / await`는 비동기 코드를 마치 동기 코드처럼 순차적으로 작성하게 해주어 가독성을 높여줍니다.
- `await 키워드`는 해당 작업(Task)이 끝날 때까지 함수 실행을 기다립니다.
- `try-catch`를 활용한 예외 처리가 쉬워집니다.

### 병렬 처리

- Task.WhenAll() 메서드를 사용하면 여러 비동기 작업을 동시에 시작하고 모두 끝날 때까지 기다릴 수 있어, 진정한 병렬성을 구현하고 성능을 극대화할 수 있습니다.

---------------------------------------------------------------

### 정리

- 동기 코드는 앱을 멈추게 할 수 있습니다.

- 콜백은 '콜백 지옥'을 만들 수 있습니다.

- `async / await`는 깔끔하고 읽기 쉬운 코드를 제공합니다.

- Unity에서는 유니티에 특화된 `UniTask`를 주로 사용하여 코루틴을 완벽히 대체됨

**`Task.WhenAll`**

- 여러 Task들이 비동기적으로 모두 완료될 때까지 기다리는 작업을 나타내는 단일 Task 객체를 반환하는 C# 메서드

