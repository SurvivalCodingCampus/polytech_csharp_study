## TODAY NOTE C# [DTO, Model, Mapper - 안정적인 데이터 처리의 핵심]  [ 25.09.15 ]

**외부 API처럼 우리가 통제할 수 없는 데이터를 다룰 때, 앱이 예기치 않게 중단되는 것을 막기 위한 방어적인 프로그래밍 전략**

**1. DTO (Data Transfer Object)**

핵심 역할: 외부에서 들어오는 데이터(JSON)를 깨질 걱정 없이 그대로 받아내는 '그릇'.

주요 특징: 모든 속성(Property)을 **Nullable(?)**로 선언하여, 데이터 일부가 누락되어도 오류 없이 일단 받아냄

비유: 어떤 내용물이든 담을 수 있는 말랑말랑한 주머니.

**2. Model**

핵심 역할: 우리 앱 내부에서 실제로 사용될, 깔끔하고 안정적인 '최종 데이터'.
주요 특징: 속성들이 Non-nullable(널 비허용)이며, 앱에 꼭 필요한 데이터만으로 구성됩니다.  이를 통해 데이터의 무결성을 보장


비유: 잘 정리된 공식 문서.

**3. Mapper**

핵심 역할: 불안정한 DTO를 안정적인 Model로 변환하는 '번역가' 또는 '정제기'.

주요 특징: null 값을 기본값(예: "")으로 바꾸고, 필요한 데이터만 추출하는 로직을 담당

비유: 날것의 재료(DTO)를 손질하여 요리(Model)로 만드는 셰프.
데이터 흐름: JSON → DTO (그릇) → Mapper (번역가) → Model (최종 결과물)

## 유닛 테스트와 Mock 
- 코드의 특정 '유닛'(클래스)이 독립적으로 잘 동작하는지 검증하는 과정

**가장 중요한 원칙**
- 유닛 테스트는 절대 외부 환경(네트워크, DB 등)에 의존해서는 안됨
- 테스트는 항상 빠르고 안정적이며, 결과가 예측 가능해야 하기 때문

**Mock (가짜 객체)의 역할** 
- 실제 외부 의존성(예: HttpClient, DataSource)을 흉내 내는 가짜 객체
- 이 가짜 객체를 이용해 특정 상황(성공, 실패 등)을 시뮬레이션하여 테스트를 진행

**계층별 테스트 전략**
**1.DataSource를 테스트할 때**
테스트 대상: PokemonApiDataSource
Mock 대상: HttpMessageHandler (가짜 HttpClient를 만들기 위해)
검증 포인트: 가짜 네트워크 응답(성공, 실패, 깨진 데이터)을 DTO로 잘 변환하는가?

**Repository를 테스트할 때**
테스트 대상: PokemonRepository

Mock 대상: IPokemonApiDataSource

검증 포인트: 가짜 DataSource가 DTO를 줬을 때, Mapper를 통해 최종 Model로 잘 변환하는가?