## TODAY NOTE C# [Result 패턴]  [ 25.09.16 ]

**Result 패턴: API 요청처럼 성공과 다양한 종류의 실패가 발생할 수 있는 작업을 처리할 때 유용한 프로그래밍 디자인 패턴**

## 핵심 개념

- 기존의 `try-catch`만으로는 처리하기 어려운 여러 실패 상황(네트워크 타임아웃, 잘못된 값, API 에러 등)을 명확하게 다루기 위해 사용
- [핵심] 매서드가 성공 시에는 데이터를, 실패 시에는 에러 정보를 담는 Result 객체를 반환하도록 설계

## 구현 방법

**Result 타입 정의**

- 성공(Success)과 실패(Error) 상태를 모두 나타낼 수 있는 추상 record 타입을 만듦

- Success: 성공 데이터를 담는 sealed record
- Error: 에러 정보를 담는 sealed record입니다.

- sealed 키워드를 사용하면 switch 문으로 모든 경우의 수를 처리하기 용이

**에러 타입 정의**

- 발생할 수 있는 에러의 종류를 enum으로 명확하게 정의합니다. (예:
  NotFound, NetworkTimeout 등)
- Repository에 적용: API 통신을 담당하는 Repository의 메서드가 Result 타입을 반환하도록 변경합니다. 이렇게 하면 메서드 선언만 봐도 어떤 성공 값과 에러들이 발생할 수 있는지 명확히 알
  수 있어 코드가 문서화되는 효과가 있습니다.

`// 반환 타입만 봐도 성공 시 Pokemon 모델을, 실패 시 PokemonError를 준다는 것을 알 수 있음`
`Task<Result<Models.Pokemon, PokemonError>> GetPokemonByNameAsync(string pokemonName);`

## 장점과 효과

- 명확한 분기 처리: switch 문을 사용해 성공했을 때와 실패했을 때의 로직, 그리고 실패 원인에 따른 로직을 명확하게 나눌 수 있습니다.
- 타입 안전성: 컴파일러가 모든 가능한 결과를 확인하도록 유도하여 에러 처리를 누락하는 실수를 방지할 수 있습니다.

## 오늘 배운 내용 실습 과제 정리

- 기본 패턴 작성: PokeAPI의 404 에러를 Result 패턴으로 처리하기.

- 테스트 코드 작성: 의도적으로 TimeoutException이나 JsonSerializationException을 발생시키는 가짜 데이터 소스(MockDataSource)를 만들어 테스트하기.

- 실전 적용: 서울시 지하철 도착 정보 API를 활용하여, Result 패턴으로 실시간 도착 정보를 조회하고 잘못된 역 이름에 대한 에러를 처리하는 기능 구현하기.