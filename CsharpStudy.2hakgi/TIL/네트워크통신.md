## 네트워크 통신

### URL을 사용한 고수준 액세스

- 고수준: 사람이 이해하기 쉽게 작성된 프로그램 또는 API
- **`URI**(Uniform Resource Identifier)`는 자원을 식별하는 가장 상위 개념이다.
- **`URL**(Locator)`은 자원의 위치(주소)를 나타내고, **`URN**(Name)`은 자원의 고유 이름을 나타낸다.
- 즉, URL과 URN은 모두 URI의 하위 개념이다.

### HTTP 개념

- HTTP(HyperText Transfer Protocol): 원래 문서 전송용으로 설계된 **상태 비저장용 프로토콜**
    - **무상태성**: HTTP는 요청 메세지를 보내기 직전까지 대상 컴퓨터가 응답 가능한지 알 방법이 없다
        - **Stateless 프로토콜**, 상태가 없는 프로토콜 (↔ TCP는 Statteful 프로토콜)
- 서버와 클라이언트가 텍스트, 이미지, 동영상 등의 데이터를 주고 받을 때 사용하는 프로토콜
    - 모든 HTTP 메세지는 **요청(Request)과 응답(Response)이 1대1로 대응**되어야 한다
        - 클라이언트는 항상 자신이 보낸 요청에 대한 응답을 알 수 있어서 로직이 단순해 지는 장점
        - 클라이언트는 서버로 HTTP **요청을 보내기 직전까지 실제로 서버가 동작하는지 알 방법이 없는 단점**
- 웹 상에서 보는 이미지, 영상, 파일과 같은 바이너리 데이터도 HTTP 멀티파트나 Base64 인코딩하여 사용
- 예측이 어려운 HTTP 응답 없음 → 가장 타임아웃 기준이 짧은 쪽을 기준으로 대비한다
    - (예) Android(10s), IOS(60s) 라면 Andoroid 기준에 맞춘다

### **OSI 7계층 (Open Systems Interconnection)**

- **OSI 7계층**은 네트워크에서 데이터가 전달되는 과정을 단계별로 나눈 **모델**
- 실제 우리가 사용하는 웹, 메일, 메신저 같은 프로그램들은 **응용 계층 (7계층)**에 해당
- 응용 계층에서 쓰는 데이터를 전달할 때
    - **데이터 송신: 표현 계층(6)** → **세션 계층(5)** → … → **물리 계층(1)**
    - 데이터 수신: 수신할 때는 1 → 7로 올라오면서 처리

### HTTP와 함께 사용하는 기술

- JSON 등을 HTTP와 함께 사용하는 RESTful API
- HTTP에 전송 계층 보안(TLS: Transport Layer Security)을 더해 만든 HTTPS

### Socket을 사용한 저수준 액세스

- 저수준: 컴퓨터가 이해하기 쉽게 작성된 프로그램 또는 API
- TCP/UDP를 추상화한 개발자를 위한 API로 프로토콜은 아니며, OSI 7계층에 포함되지 않는다

### TCP

- 신뢰성 있는 연결지향성 앱에서 사용 (이메일, 파일 전송, 웹브라우저) `Stateful 프로토콜`
- 연결되면 연결을 끊기 전까지 계속 메시지를 주고 받는 프로토콜
- 한쪽에 문제가 생기면 다른쪽에서 감지 가능
- 텍스트가 아닌 바이너리 데이터를 전송
- 패킷 크기가 HTTP에 비해 작음 → 속도 빠름
- 각 요청이 소켓 1개를 공유(HTTP는 각 요청이 소켓 1개씩 사용)하므로 요청을 식별할 식별자가 필요
- 응답을 알 수 있는 방법이 없기 때문에 타임아웃에 대해 직접 구현해야 함

### TCP/IP

- Socket을 사용해 TCP/IP 통신이 간으하다
- 접속하기 위해서는 IP, 포트 번호가 필요하다

### TCP와 HTTP의 차이

- TCP는 HTTP보다 빠르지만 개발자가 할 일이 많다
- HTTP는 로직이 간단하지만 TCP보다는 느리다

### UDP

- **비연결형, 단순 전송**: 연결 절차 없이 바로 데이터그램을 전송 → 빠르지만 신뢰성 낮음
- **보장 없음**: 패킷 손실, 순서 뒤바뀜 가능 / 흐름 제어, 오류 복구 없음
- **활용**: 멀티캐스트·브로드캐스트, 스트리밍, 온라인 게임, 실시간 통신(VoIP 등)

### HTTP 요청 메서드의 종류

- 요청의 형태를 정의하는 키워드
- 상황에 맞게 사용하는 것이 관례
    - GET : 데이터 요청
    - POST : 데이터가 포함된 요청
    - DELETE : 삭제
    - PUT : 전부 업데이트
    - PATCH : 일부 업데이트
- [참고] https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Methods

### 실습

- http_test.http 파일 생성

    ```csharp
    ### 모든 posts
    GET https://jsonplaceholder.typicode.com/posts
    
    ### posts 특정 id 
    GET https://jsonplaceholder.typicode.com/posts?id=1
    
    ### POST 쓰기
    POST https://jsonplaceholder.typicode.com/posts
    Content-Type: application/json 
    
    {
      "userId": 1,
      "title": "test",
      "body": "test"
    }
    
    ### POST 삭제
    DELETE https://jsonplaceholder.typicode.com/posts/10
    
    ### POST 전체 수정
    PUT https://jsonplaceholder.typicode.com/posts/1
    Content-Type: application/json
    
    {
      "userId": 200,
      "title": "one",
      "body": "one"
    }
    
    ### POST 일부 수정
    PATCH https://jsonplaceholder.typicode.com/posts/1
    Content-Type: application/json
    
    {
      "title": "test"
    }
    
    ```


### HTTP 응답 상태 코드

- 모든 HTTP 응답에는 상태 코드와 상태 메시지가 있음
- 200 OK
- 400 Bad Request
- 404 Not Found
- 500 Internal Server Error

### 세션과 쿠키

- HTTP는 상태라는 개념이 존재하지 않기 때문에 세션과 쿠키를 사용해 구분
- 주로 웹에서 서버는 세션, 클라이언트는 쿠키를 통해 상태 저장
- 모바일에 없는 개념 : SharedPreference 등으로 구현

### **RESTful API**

- 서버와 클라이언트가 메시지를 주고받을 때 가장 많이 사용하는 암묵적인 룰
- REST(representational state transfer): 분산 시스템을 위한 소프트웨어 아키텍처의 한 형태
- RESTful 이란 REST 조건을 만족한다는 뜻
- 요청 주소(URL)과 메서드(GET, POST 등), JSON 규격을 이용하여 API를 정의하며 가장 범용적으로 사용
- [참고] https://aws.amazon.com/ko/what-is/restful-api/
- [참고] JetBrains에서 제공하는 `httpClient` 플로그인 사용하면 편리함
- [참고: Json 데이터 제공 연습용 사이트] https://jsonplaceholder.typicode.com/

### Http 통신을 위한 클래스

- C# : HttpClient
- 유니티 : UnityWebRequest