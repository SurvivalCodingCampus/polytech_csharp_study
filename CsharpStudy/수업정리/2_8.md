# 📑 DataSource & Async/Task 정리

## 1. DataSource의 역할

- 외부 데이터 저장소와 직접 통신
- Raw 데이터 수신 및 처리
- CRUD(Create, Read, Update, Delete) 수행

  👉 **데이터의 생성, 조회, 갱신, 삭제 담당 계층**


---

## 2. DataSource의 종류

- Text 파일
- JSON
- XML
- Database 등

---

## 3. 사용 예시

- 게임/앱의 아이템 데이터 관리
- 세이브 파일 저장 및 불러오기

---

## 4. DataSource 기능 정의

- 데이터 소스를 추상화하는 **인터페이스 제공**
- `Task` 기반 비동기 함수로 구현 → 앱 성능 유지

```csharp
public interface IDataSource
{
    Task<List<Person>> GetPeopleAsync();
    Task SavePeopleAsync(List<Person> people);
}

```

---

## 5. 실습하며 정리한 비동기/Task 개념

### ① Task 반환 패턴

- `Task.CompletedTask` → **값 없는 동기 작업**을 Task 모양으로 반환
- `Task.FromResult(x)` → **값 있는 동기 결과**를 Task<T>로 반환
- `async/await` + `…Async()` → **진짜 비동기 I/O** 처리

### ② 동기 vs 비동기 차이

- 동기: 작업이 끝날 때까지 스레드가 블로킹됨
- 비동기: OS에 I/O를 맡기고 스레드는 즉시 반환 → UI/서버 멈춤 방지

### ③ 코드 예시

```csharp
// 동기 + CompletedTask
public Task SavePeopleAsync(List<Person> people)
{
    File.WriteAllText(_filePath, JsonSerializer.Serialize(people));
    return Task.CompletedTask;
}

// 동기 결과 → Task로 감싸기
public Task<List<Person>> GetPeopleAsync()
{
    var people = new List<Person>();
    return Task.FromResult(people);
}

// 진짜 비동기
public async Task<List<Person>> GetPeopleAsync()
{
    await using var stream = File.OpenRead(_filePath);
    return await JsonSerializer.DeserializeAsync<List<Person>>(stream)
           ?? new List<Person>();
}

```

---

## 6. 요약

- **DataSource** = 외부 데이터 저장/로드 담당 계층
- **비동기 처리**는 필수 → UI 프리징, 서버 응답 지연 방지
- `Task.CompletedTask` / `Task.FromResult` = 형식 맞춤용
- `async/await` + `…Async()` = 실제 비동기